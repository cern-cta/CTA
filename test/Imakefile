COMM       @(#)Imakefile,v 1.3 2000/01/07 14:58:20 CERN IT-PDP/DM Jean-Philippe Baud
COMM
COMM  Copyright (C) 1999 by CERN/IT/PDP/DM
COMM  All rights reserved
COMM

COMM		Make CASTOR tests

#include <Project.tmpl>

SUBDIRS = $(COMMONDIR) $(DBDIR) $(MSGDIR) $(NSDIR) $(RFIODIR) \
	  $(SYSREQDIR) $(RTCOPYDIR) $(STAGEDIR) $(TAPEDIR) \
	  $(COPYTAPEDIR) $(DLFDIR)

MakeSubdirs(all,$(SUBDIRS))
MakeSubdirs(clean,$(SUBDIRS))
MakeSubdirs(clobber,$(SUBDIRS))

#if defined(_WIN32)
Makefiles:
	@for %i in ( $(SUBDIRS) ) \
	do @(echo test\\%i - & cd %i & \
		..\..\imake\imake -I..\..\config & \
		$(MAKE) $(MFLAGS) $@ & cd .. )

depend:
	@echo Not supported on this platform
#else
Makefiles:
	@. ../setosflags ;\
	for i in $(SUBDIRS) ;\
	do (if [ -d $$i ] ;\
	    then \
	      (echo " $$i:" ; cd $$i ;\
	      ../../imake/imake -I../../config -DOSMajorVersion="$$OSMAJNO" -DOSMinorVersion="$$OSMINNO" ;\
	      $(MAKE) $(MFLAGS) $@) ;\
	    else \
	      (echo "ERROR : No directory $$i" ;\
	      exit 1) ;\
	    fi )\
	done ;

depend:
	for i in $(SUBDIRS) ;\
	do (if [ -d $$i ] ;\
	    then \
	      (echo " test/$$i:" ; cd $$i ;\
	      $(MAKE) $(MFLAGS) $@) ;\
	    else \
	      (echo "ERROR : No directory $$i" ;\
	      exit 1) ;\
	    fi )\
	done ;

#endif
