.lf 1 dlfserver.man
.TH dlfserver 1 "$Date: 2006/06/20 13:35:02 $ CERN IT-FIO" CASTOR "DLF Server"
.SH NAME
dlfserver \- start the CASTOR Distributed Logginf Facility server
.SH SYNOPSIS
.B dlfserver [OPTIONS]

(see dlfserver --help for full list of options)
.SH DESCRIPTION
The 
.BR dlfserver
command starts the DLF server daemon process. The command is usually executed at system start-up time
.RC ( /etc.rc.local).
This will source the dlfserver sysconfig file and launch the server with two thread pools. One pool for receiving connections from remote hosts and another for database interactivity. 

.SH OPTIONS
The program is usually run without any arguments.
.TP
.B \-d
Enable debugging mode.
.TP
.B \-f
Keep the process in the foreground, do not fork.
.TP
.B \-f
Display the help message and exit.
.TP
.B \-l <path>
Full path to where the server should record its runtime error log. The ouptut can be directed to stdout by specify "stdout" as the path.
.TP
.B \-p <port>
The servers listening port.
.TP
.B \-t <transport_threads>:<db_threads>
The number of transport threads in relation to database threads. Please note, that the transport threads are multiplexed and are capable of handle multiple connections. By default the server utilises 2 transport threads each capable of servicing 150 each.
.TP
.B \-n
Disable the generation of job and request statistics.

.SH "FILES"
In order to connect to the DLF database a username, password and server are required. The configuration file /etc/DLFCONFIG defines this information using a signal line in the format:
username/password@serv

Under Oracle the 'serv' name represents the server name of tns name of the database, while under Mysql it represents the aliased or physical hostname of the machine running the mysqld process.

.SH "FIRST RUN"
Prior to running the server for the first time the DLF database schema must be setup within the relational database. Failure to setup the schema will result in the dlfserver shutting down.

.SH NOTES
The dlfserver is basically a large memory cache acting as a gateway for recording logging messages into an oracle or mysql database backend.  It has the capacity to store 
.BR MAX_QUEUE_SIZE 
messages pending database insertion as defined in dlf/server.h. As a result a large portion of memory (several hundreds of megabytes) can be allocated to the server at any given time.

Every five minutes the server generates statistics for the last 5 minutes detailing its activities over this time period. The results are stored in the dlf_monitoring relation database tables in the dlf schema. The table details the number of incoming messages, client connections, database insertions, commits, processes messages, the number of messages queued, the average lifetime of a message with the memory cache and many other server related data points. This data can provide the first indications of database problems or server saturation and should be the first source of data analysed whenever problems occur.

There are no external command offered by the dlf tool suite to enter new facilities into the DLF system. Facilities must be registered manually using an appropriate SQL statement on the dlf_facilities table.

.SH AUTHOR
\fBCASTOR\fP Team <castor.support@cern.ch>