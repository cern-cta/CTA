'''
Created on Jul 13, 2010
suggesting parameters to TreeCalculators and TreeDesigner.
These properties are used as standard values, if nothing else is given.
Using these guideline values, TreeCalculators and TreeDesigner set properties for every ViewNode in ViewTree.

All of this result in following Properties of a ViewNode:

set by TreeCalculators:
treenode - original TreeNode object from data tree generated by TreeBuilder
spacesize - space to neighbour rectangles, in px
captionsize - height of the rectangle caption, in px
width - rectangle width
height - rectangle height
x - rectangle x pos in the image
y - rectangle y pos in the image

set by TreeDesigner:
captiontext - text string to show in the rectangle caption
captiontextisbold - defines if the caption text should be bold
htmltooltiptext - defines the tooltip text for that node
fillcolor - color the rectangle should be filled with
level - level inside of the data tree (root is 0, ascending)
radiallight {'brightness': b, 'hue':h, 'opacity': o } - defines brightness, hue and opacity of the "light" shining at the rectangle

@author: kblaszcz
'''
#numbers must be floats!
from app.treemap.objecttree.ObjectTree import ObjectTree
from app.treemap.viewtree.ViewTree import ViewTree


treemap_props = {
'pxwidth': 800.0, #width
'pxheight': 600.0, #height  
'captionsize': 12.0,
'spacesize': 2.0,
'spacesizedecrease': 0.5,
'minspacesize': 2.0,
'inbordersize': 0.0,
'captionfontsize': 12.0, 
'radiallightbrightness': 0.4,
'captiontextisbold': True, 
'caption': True,
'padding': True,
'objecttree': None, #will be set when available (by TreeBuilder)
'viewtree': None, #will be set when available (by SquaredTreemapCalculator) 
'levelrules': None,#will be set when available (by the view)
}

def checkAndPartiallyCorrectTreemapProps(props):
    height = props['pxheight']
    width = props['pxwidth']
    captionsize = props['captionsize']
    spacesize = props['spacesize']
    minspacesize = props['minspacesize']
    inbordersize = props['inbordersize']
    captionfontsize = props['captionfontsize']
    radiallightbrightness = props['radiallightbrightness']
    captionfontsize = props['captionfontsize']
    
    if captionsize > height:
        props['captionsize'] = height * 0.02
        
    if spacesize > min(width, height) * 0.5:
        props['spacesize'] = 0.0
        
    if minspacesize <= spacesize and minspacesize >= 0.0:
        props['minspacesize'] = minspacesize
        
    assert(isinstance(props['objecttree'], ObjectTree) or isinstance(props['objecttree'], None))
        
    if inbordersize > min(width, height) * 0.5:
        props['inbordersize'] = 0.0

        
    if captionfontsize > captionsize - inbordersize:
        props['captionfontsize'] = captionsize - inbordersize
        
    if radiallightbrightness > 1.0 or radiallightbrightness < 0.0:
        props['radiallightbrightness'] = 0.4
    
    assert(isinstance(props['viewtree'], ViewTree) or isinstance(props['viewtree'], None))

        


        