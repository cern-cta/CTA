{{- /*
SPDX-FileCopyrightText: 2025 CERN
SPDX-License-Identifier: GPL-3.0-or-later
*/ -}}

{{- $schedulerConfig := include "scheduler.config" . | fromYaml }}
{{- if eq $schedulerConfig.backend "vfs" }}
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: scheduler-vfs-pvc
  annotations:
    {{- if $schedulerConfig.vfsConfig.annotations }}
    {{- toYaml $schedulerConfig.vfsConfig.annotations | nindent 4 }}
    {{- end }}
spec:
  accessModes:
    {{- range $schedulerConfig.vfsConfig.accessModes }}
    - {{ . | quote }}
    {{- end }}
  resources:
    requests:
      storage: {{ $schedulerConfig.vfsConfig.size | quote }}
  {{- if (eq "-" $schedulerConfig.vfsConfig.storageClass) }}
  storageClassName: ""
  {{- else }}
  storageClassName: "{{ $schedulerConfig.vfsConfig.storageClass }}"
  {{- end }}
{{- end }}
