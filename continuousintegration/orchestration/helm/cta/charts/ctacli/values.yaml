# If required, the user can specify a custom image here
image:
component: ctacli
partOf: cta
nameOverride: ctacli
isPriviliged: true

conf:
  cta:
    endpoint: ctafrontend:10955
  eos:
    instance: ctaeos
    requester:
      user: adm
      group: powerusers

# Changes the entrypoint of the image to the script and provide arguments if needed
customEntrypoint:
  command: ["/bin/sh", "-c"]
  args:
  - |
    cat /tmp/eos.keytab > /etc/eos.keytab;
    chmod 600 /etc/eos.keytab;
    /opt/run/bin/ctacli.sh

# Additional environment variables
env:
- name: TERM
  value: "xterm"

service:
  ports:
  - name: ctacli
    port: 1
    protocol: TCP

# defines all of the volumes consumed by pod
volumes:
- name: keytab
  secret:
    secretName: ctaadmin1-keytab
- name: sss-keytab
  secret:
    defaultMode: 400
    secretName: eos-sss-keytab
- name: krb5-config-volume
  configMap:
    name: krb5-config

volumeMounts:
- name: keytab
  mountPath: /root/ctaadmin1.keytab
  subPath: ctaadmin1.keytab
- name: sss-keytab
  mountPath: /tmp/eos.keytab
  subPath: eos.keytab
- name: krb5-config-volume
  mountPath: /etc/krb5.conf
  subPath: krb5.conf
