# !!!!!!!! Line 289 of LogginCommon changed to let it work with Scribe !!!!!!!!!!!!
# (into: path += "%d%02d%02d/c2aggregated_00000" % (p.year, p.month, p.day))


#-------------------------------------------------------------------------------
# General program settings
#-------------------------------------------------------------------------------
[main]
pid_file         = /var/run/logprocessord.normal.pid
log_file         = /var/log/castor/logprocessord.log
plugin_path      = /usr/lib/log-processor
daemon_processes = ComputeMetricsFromScribe

#-------------------------------------------------------------------------------
# Destination
#-------------------------------------------------------------------------------
[dest-MetricsAnalysisEngine_dest]
module=MetricsAnalysisEngine_dest
class=ComputeMetrics


#-------------------------------------------------------------------------------
# Source
#-------------------------------------------------------------------------------
[source-Scribe_source]
module = Scribe_source
class  = ScribeLogFile

# There are basically two types of input that the logprocessor operates on:
# files and pipes.

# If the type is set to 'file' then it treats the file specified by the path
# variable as the source for the messages. It reads the file treating each line
# as a separate message and parses it. When it reaches the end of the file it
# closes it and quits.

# If the type is set to 'pipe' then it blocks until new data is available in
# the currently opened file.

# The 'seek' variable determines if it should find the end of the file and
# insert only the newly arriving messages, if set to false it also inserts the
# messages that are already in the file.

# The 'dynfiles' option specific if dynamic file names should be parsed. If
# set to false the pipe just processes the file specified by path. If set to
# true then the pipe processes the YYYY-MM-DD.log files stored in the directory
# defined by the path variable (YYYY denotes year, MM - month, and DD - day).
# It starts with the current date and changes the file it processes when there
# is no more data in the current one and the system date changes.

####
path     = /var/log/scribe/castor/c2aggregated/c2aggregated/
type     = pipe
dynfiles = true
seek     = true
####


#-------------------------------------------------------------------------------
# Processes
#-------------------------------------------------------------------------------

[process-ComputeMetricsFromScribe]
source=Scribe_source
destination=MetricsAnalysisEngine_dest

