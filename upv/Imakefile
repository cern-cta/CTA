COMM
COMM  Copyright (C) 1999-2002 by CERN/IT/PDP/DM
COMM  All rights reserved
COMM
COMM       @(#)Imakefile,v 1.3 2005/01/23 08:49:33 CERN IT-PDP/DM Ben Couturier

COMM    Make UPV programs.

#if BuildSecureCupv
CPPFLAGS += -DUPVCSEC
#endif

CPPFLAGS += $(ORACLE_CPPFLAGS)

CommonDependsOnLibrary(common,castorcommon)
CUPVLIB_OBJS = Cupv_apiinit.o Cupv_errmsg.o send2Cupv.o Cupv_delete.o Cupv_list.o Cupv_util.o Cupv_check.o Cupv_modify.o Cupv_add.o
SharedLibraryTarget(castorupv,$(CUPVLIB_OBJS),,)

CLIENTLIBMANPAGE(Cupv_add)
CLIENTLIBMANPAGE(Cupv_check)
CLIENTLIBMANPAGE(Cupv_delete)
CLIENTLIBMANPAGE(Cupv_list)
CLIENTLIBMANPAGE(Cupv_modify)

ClientDependsOnLibrary(upv,castorupv)
ClientProgramTarget(Cupvadd, Cupvadd.o,,,755)
ClientProgramTarget(Cupvmodify, Cupvmodify.o,,,755)
ClientProgramTarget(Cupvcheck, Cupvcheck.o,,,755)
ClientProgramTarget(Cupvdelete, Cupvdelete.o,,,755)
ClientProgramTarget(Cupvlist, Cupvlist.o,,,755)

CLIENTEXEMANPAGE(Cupvadd)
CLIENTEXEMANPAGE(Cupvmodify)
CLIENTEXEMANPAGE(Cupvcheck)
CLIENTEXEMANPAGE(Cupvdelete)
CLIENTEXEMANPAGE(Cupvlist)

PROC(Cupv_oracle_ifce)
CUPVD_OBJS = Cupv_main.o Cupv_oracle_ifce.o Cupv_procreq.o sendrep.o Cupv_util.o Cupvlogit.o
MakeDir($(LOGPATH),0755)
ORALIBS= -L$(ORACLE_LIBDIR) -lclntsh
NormalProgramTarget(cupvd,$(CUPVD_OBJS),,$(ORALIBS),755)
ADMMANPAGE(cupvd)
LOGROTATE(castor-upv-server,install)
SYSCONFIG(cupvd,install)
INITSCRIPT(cupvd,install)
CONFIGFILE(CUPV,install)

