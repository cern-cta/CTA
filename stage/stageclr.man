.\" $Id: stageclr.man,v 1.18 2003/06/30 11:31:05 jdurand Exp $
.\"
.\" @(#)$RCSfile: stageclr.man,v $ $Revision: 1.18 $ $Date: 2003/06/30 11:31:05 $ CERN IT-PDP/DM Jean-Philippe Baud
.\" Copyright (C) 1994-2002 by CERN/IT/DS/HSM
.\" All rights reserved
.\"
.TH STAGECLR "1" "$Date: 2003/06/30 11:31:05 $" "CASTOR" "Stage User Commands"
.SH NAME
stageclr \- remove staged files
.SH SYNOPSIS
.B stageclr
[
.BI \-c
] [
.BI \-F
] [
.BI \-h " host"
] [
.BI \-m " minfree"
] [
.BI \-p " pool"
] [
.BI \-\-nodisk
] [
.BI \-remove_from_hsm
] [
.BI \-\-reqid " reqid"
]
.BI \-M " hsmfile"
.P
.B stageclr
[
.BI \-c
] [
.BI \-F
] [
.BI \-h " host"
] [
.BI \-m " minfree"
] [
.BI \-\-nodisk
] [
.BI \-\-reqid " reqid"
]
.BI \-P " pathname"
.P
.B stageclr
[
.BI \-c
] [
.BI \-F
] [
.BI \-h " host"
] [
.BI \-m " minfree"
] [
.BI \-\-nodisk
] [
.BI \-\-reqid " reqid"
]
.BI \-i
.P
.B stageclr
[
.BI \-h " host"
] [
.BI \-F
] [
.BI \-\-nodisk
] [
.BI \-\-reqid " reqid"
]
.BI \-L " link_name"
.SH DESCRIPTION
.B stageclr
removes staged files from disk if the requestor is in the same group as the
user who created the disk file.
.SH OPTIONS
.TP
.BI \-c
conditional clear. If this option is specified the remove operation is done
only if the free space in the pool is lower than a minimum.
This minimum may be specified thru the option
.BR \-m .
.TP
.BI \-F
Forces request to be deleted - admin user only except when used with with \-M option, for which deletion in the HSM is forced and done under requestor uid/gid.
.TP
.BI \-h " host"
Sends the request to the stager on
.IR host .
This may also be specified thru the environment variable STAGE_HOST.
.BI \-i
the list of pathnames to be removed is read from
.IR stdin .
If the operation fails on a path,
.B stageclr
continues with the next path in the list and the global exit code corresponds
to the first failure.
.TP
.BI \-L " link_name"
gives the pathname of the user link to be removed. The data file is not
removed.
.TP
.BI \-M " hsmfile"
clears in the stager catalog the entry corresponding to this HSM file and
remove the staged file from the pool, but it does not remove the file from
the Hierarchical Storage Management System.
This operation should be explicitely requested with the option
.BR \-remove_from_hsm .
.TP
.BI \-m " minfree"
specifies the minimum free space to be available in the pool.
This is a percentage.
For example,
.B \-m 10
corresponds to 10% of free space.
The default minfree value is taken from the configuration file
.B /etc/STGCONFIG.
.TP
.BI \-P " pathname"
gives the path name of the file to be purged,
either full internal name or user link name.
.TP
.BI \-p " poolname"
restricts the action to a given pool.
.TP
.BI \-\-nodisk
Prevent stager daemon to do disk access. The entry is removed from the main catalog in case of a file in stager filesystems, and from the link catalog in a case of a link name (\-L option). Stager will not try to remove physically the file. In case of an entry in stager filesystem, space knowledge of the corresponding filesystem is unchanged.
.TP
.BI \-remove_from_hsm
to remove the file from the Hierarchical Storage Management System as well.
.TP
.BI \-\-reqid " reqid"
to remove only entry that has this explicit request ID.
.\" .TP
.\" .B \-\-side "sidenumber"
.\" Tells which side of the device you refer to (applies to multi-side medias files yet in the disk pool, like DVD). Only when used with
.\" .B \-V
.\" option.

.SH RETURN CODES
\
.br
0	Ok.
.br
1	Bad parameter.
.br
2	System error.
.br
3	Unknown error.

.SH SEE ALSO
\fBstage_other_options\fP(1)

.SH AUTHOR
\fBCASTOR\fP Team <castor.support@cern.ch>
