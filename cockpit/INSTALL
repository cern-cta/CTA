
###################################################################################################
#   INSTALATION NOTES FOR CASTOR MONITORING COCKPIT
###################################################################################################

1*) include {'cluster/ahc/roles/django-server'};  in the profile template => spma + ncm

2*) start mysqld then change root password of mysql
    
    # /etc/init.d/mysqld start

3*) change database login/password in castormon/settings.py (marked with @TODO)
3bis*) change the SECRET_KEY in castormon/settings.py !! (marked with @TODO)
3ter*) change the server name in httpd cockpit config file (by default /etc/httpd/conf.d/cockpit-httpd.conf)

4*) create cockpit database using :
NB : if not already done, change root password of mysql !

    $ mysql -u root -p
    mysql> CREATE DATABASE cockpit CHARACTER SET utf8;

5*) in the directory of the application (by default /var/www/castormon ), use :

    $ python manage.py syncdb
        
        Here you may be asked to create a superuser for django.

    $ python manage.py migrate cockpit

6*) finally start apache :

    # /etc/init.d/httpd start -d



###################################################################################################
#   DJANGO STEPS : should not be necessary if installed from provided RPM !!!
###################################################################################################
3*) upload cockpit django application files to /var/www/castormon
 -> http://svnweb.cern.ch/world/wsvn/CASTOR/CASTOR2/trunk/cockpit/castormon/



###################################################################################################
#   NCM STEPS : should not be necessary !!!!
###################################################################################################

*) set "/etc/httpd/conf.d/cockpit-httpd.conf" to :

NameVirtualHost *:80
WSGISocketPrefix /var/run/wsgi
<VirtualHost *:80>
        ServerName lxc2dev8d1.cern.ch
        DocumentRoot /var/www/castormon/
        Alias /static/ /var/www/castormon/staticfiles/
        <Directory /var/www/castormon/>
                Order deny,allow
                Allow from all
                Options -Indexes
        </Directory>
        WSGIDaemonProcess cockpit user=apache group=apache threads=25
        WSGIProcessGroup cockpit
        WSGIScriptAlias / /var/www/castormon/django.wsgi
</VirtualHost>


*) switch on wsgi module : set "/etc/httpd/conf.d/wsgi.conf" to

LoadModule wsgi_module modules/mod_wsgi.so


*) set SE-linux boolean : 
    httpd_can_network_connect=true
    allow_user_mysql_connect=true

    using : 
        # setsebool httpd_can_network_connect="on" allow_user_mysql_connect="on"


