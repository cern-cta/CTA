COMM
COMM  Copyright (C) 1999-2003 by CERN/IT/PDP/DM
COMM  All rights reserved
COMM
COMM       @(#)$RCSfile: Imakefile,v $ $Revision: 1.18 $ $Date: 2009/08/18 09:43:02 $ CERN IT-PDP/DM Jean-Philippe Baud

COMM    Make volume manager programs.

#if BuildSecureVmgr
CPPFLAGS += -DVMGRCSEC
AddLdFlags(-ldl)
#endif
CPPFLAGS += -DVMGRLOGFILE=VmgrLogFile -DVMGRCONFIG=VmgrConfigFile -I$(ORACLE_HOME)/precomp/public

CommonDependsOnLibrary(ns,castorns)
CommonDependsOnLibrary(common,castorcommon)
CommonDependsOnLibrary(upv,castorupv)

MakeDir(LogPath,0755)
PROC(vmgr_oracle_ifce)
VMGRD_OBJS = vmgr_main.o vmgr_oracle_ifce.o vmgr_procreq.o sendrep.o vmgrlogit.o
ORALIBS= -L$(ORACLE_HOME)/lib -lclntsh
NormalProgramTarget(vmgrd,$(VMGRD_OBJS),,$(ORALIBS),750)
ADMMANPAGE(vmgrd)
LOGROTATE(castor-vmgr-server,install)
SYSCONFIG(vmgrd,install)
INITSCRIPT(vmgrd,install)
CONFIGFILE(VMGR,install)

VMGRLIB_OBJS = vmgr_apiinit.o vmgr_deletedenmap.o vmgr_deletedgnmap.o vmgr_deletelibrary.o vmgr_deletemodel.o vmgr_deletepool.o vmgr_deletetape.o vmgr_deltag.o vmgr_enterdenmap.o vmgr_enterdgnmap.o vmgr_enterlibrary.o vmgr_entermodel.o vmgr_enterpool.o vmgr_entertape.o vmgr_errmsg.o vmgr_gettag.o vmgr_gettape.o vmgr_listdenmap.o vmgr_listdgnmap.o vmgr_listlibrary.o vmgr_listmodel.o vmgr_listpool.o vmgr_listtape.o vmgr_modifylibrary.o vmgr_modifymodel.o vmgr_modifypool.o vmgr_modifytape.o vmgr_querylibrary.o vmgr_querymodel.o vmgr_querypool.o vmgr_querytape.o vmgr_reclaim.o vmgr_settag.o vmgr_tpmounted.o vmgr_updatetape.o send2vmgr.o vmgrcheck.o
ClientSharedLibraryTarget(castorvmgr,$(VMGRLIB_OBJS),,)

LIBMANPAGE(vmgr_deletedenmap)
LIBMANPAGE(vmgr_deletedgnmap)
LIBMANPAGE(vmgr_deletelibrary)
LIBMANPAGE(vmgr_deletemodel)
LIBMANPAGE(vmgr_deletepool)
LIBMANPAGE(vmgr_deletetape)
LIBMANPAGE(vmgr_deltag)
LIBMANPAGE(vmgr_enterdenmap)
LIBMANPAGE(vmgr_enterdgnmap)
LIBMANPAGE(vmgr_enterlibrary)
LIBMANPAGE(vmgr_entermodel)
LIBMANPAGE(vmgr_enterpool)
LIBMANPAGE(vmgr_entertape)
LIBMANPAGE(vmgr_gettag)
LIBMANPAGE(vmgr_gettape)
LIBMANPAGE(vmgr_listdenmap)
LIBMANPAGE(vmgr_listdgnmap)
LIBMANPAGE(vmgr_listlibrary)
LIBMANPAGE(vmgr_listmodel)
LIBMANPAGE(vmgr_listpool)
LIBMANPAGE(vmgr_listtape)
LIBMANPAGE(vmgr_modifylibrary)
LIBMANPAGE(vmgr_modifymodel)
LIBMANPAGE(vmgr_modifypool)
LIBMANPAGE(vmgr_modifytape)
LIBMANPAGE(vmgr_querylibrary)
LIBMANPAGE(vmgr_querymodel)
LIBMANPAGE(vmgr_querypool)
LIBMANPAGE(vmgr_querytape)
LIBMANPAGE(vmgr_reclaim)
LIBMANPAGE(vmgr_seterrbuf)
LIBMANPAGE(vmgr_settag)
LIBMANPAGE(vmgr_tpmounted)
LIBMANPAGE(vmgr_updatetape)

VMGRLIB = DepSharedLibraryTargetName(vmgr,castorvmgr)
ClientProgramTarget(vmgrdeletedenmap,vmgrdeletedenmap.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrdeletedgnmap,vmgrdeletedgnmap.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrdeletelibrary,vmgrdeletelibrary.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrdeletemodel,vmgrdeletemodel.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrdeletepool,vmgrdeletepool.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrdeletetape,vmgrdeletetape.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrdeltag,vmgrdeltag.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrenterdenmap,vmgrenterdenmap.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrenterdgnmap,vmgrenterdgnmap.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrenterlibrary,vmgrenterlibrary.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrentermodel,vmgrentermodel.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrenterpool,vmgrenterpool.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrentertape,vmgrentertape.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrgettag,vmgrgettag.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrlistdenmap,vmgrlistdenmap.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrlistdgnmap,vmgrlistdgnmap.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrlistlibrary,vmgrlistlibrary.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrlistmodel,vmgrlistmodel.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrlistpool,vmgrlistpool.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrlisttape,vmgrlisttape.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrmodifylibrary,vmgrmodifylibrary.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrmodifypool,vmgrmodifypool.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrmodifytape,vmgrmodifytape.o,$(VMGRLIB),$(VMGRLIB),755)
ClientProgramTarget(vmgrsettag,vmgrsettag.o,$(VMGRLIB),$(VMGRLIB),755)
EXEMANPAGE(vmgrdeletedenmap)
EXEMANPAGE(vmgrdeletedgnmap)
EXEMANPAGE(vmgrdeletelibrary)
EXEMANPAGE(vmgrdeletemodel)
EXEMANPAGE(vmgrdeletepool)
EXEMANPAGE(vmgrdeletetape)
EXEMANPAGE(vmgrdeltag)
EXEMANPAGE(vmgrenterdenmap)
EXEMANPAGE(vmgrenterdgnmap)
EXEMANPAGE(vmgrenterlibrary)
EXEMANPAGE(vmgrentermodel)
EXEMANPAGE(vmgrenterpool)
EXEMANPAGE(vmgrentertape)
EXEMANPAGE(vmgrgettag)
EXEMANPAGE(vmgrlistdenmap)
EXEMANPAGE(vmgrlistdgnmap)
EXEMANPAGE(vmgrlistlibrary)
EXEMANPAGE(vmgrlistmodel)
EXEMANPAGE(vmgrlistpool)
EXEMANPAGE(vmgrlisttape)
EXEMANPAGE(vmgrmodifylibrary)
EXEMANPAGE(vmgrmodifypool)
EXEMANPAGE(vmgrmodifytape)
EXEMANPAGE(vmgrsettag)
EXEMANPAGE(vmgr)
