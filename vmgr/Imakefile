COMM
COMM  Copyright (C) 1999-2003 by CERN/IT/PDP/DM
COMM  All rights reserved
COMM
COMM       @(#)$RCSfile: Imakefile,v $ $Revision: 1.13 $ $Date: 2008/11/26 14:52:00 $ CERN IT-PDP/DM Jean-Philippe Baud

COMM    Make volume manager programs.

OPSGRP = OperatorGid
SPOOL = VmgrSpool
LOGFILE = $(SPOOL)/log
SACCTDIR = SacctDir
SACCTFILE = SacctDir/sacct
ACCTFILE = -DACCTFILE=\"$(SACCTFILE)\"
VMGRCONFIG = VmgrConfigFile
VMGR_HOST = VmgrHost
ORAFLG = -DUSE_ORACLE
ORAINC = -I$(ORACLE_HOME)/precomp/public
#if BuildSecureVmgr
SECURITYFLAG=-DCSEC
LIBS+= -ldl
#endif  
CFLAGS = -g -I../h $(MTCCFLAGS) -DBIN=\"$(BIN)\" -DVMGR_HOST=\"$(VMGR_HOST)\" -DLOGFILE=\"$(LOGFILE)\" -DVMGRCONFIG=\"$(VMGRCONFIG)\" $(ACCTFLAG) $(ACCTFILE) $(RDSFLG) $(ORAFLG) $(RDSINC) $(ORAINC) $(SECURITYFLAG)

DependsOnLibrary(common,castorcommon)
DependsOnLibrary(upv,castorupv)

#if BuildVolumeMgrDaemon
MakeDir($(SPOOL),root,bin,0755)
MakeDir($(SACCTDIR),root,bin,0777)
vmgr_oracle_ifce.c: vmgr_oracle_ifce.pc
	proc iname=vmgr_oracle_ifce include=../h  threads=yes char_map=string parse=full
FilesToClean += vmgr_oracle_ifce.c vmgr_oracle_ifce.lis
VMGRDAEMON_OBJS = vmgr_main.Osuf vmgr_oracle_ifce.Osuf vmgr_procreq.Osuf sendrep.Osuf vmgrlogit.Osuf
ORALIBS= -L$(ORACLE_HOME)/lib -lclntsh
NormalProgramTarget(vmgrdaemon,$(VMGRDAEMON_OBJS), $(DEPLIB), $(ORALIBS) $(MTLDFLAGS) $(LIBS),root,bin,750)
ADMMANPAGE(vmgrdaemon)
#endif

#if BuildVolumeMgrLibrary
VMGRLIB_OBJS = vmgr_apiinit.Osuf vmgr_deletedenmap.Osuf vmgr_deletedgnmap.Osuf vmgr_deletelibrary.Osuf vmgr_deletemodel.Osuf vmgr_deletepool.Osuf vmgr_deletetape.Osuf vmgr_deltag.Osuf vmgr_enterdenmap.Osuf vmgr_enterdgnmap.Osuf vmgr_enterlibrary.Osuf vmgr_entermodel.Osuf vmgr_enterpool.Osuf vmgr_entertape.Osuf vmgr_errmsg.Osuf vmgr_gettag.Osuf vmgr_gettape.Osuf vmgr_listdenmap.Osuf vmgr_listdgnmap.Osuf vmgr_listlibrary.Osuf vmgr_listmodel.Osuf vmgr_listpool.Osuf vmgr_listtape.Osuf vmgr_modifylibrary.Osuf vmgr_modifymodel.Osuf vmgr_modifypool.Osuf vmgr_modifytape.Osuf vmgr_querylibrary.Osuf vmgr_querymodel.Osuf vmgr_querypool.Osuf vmgr_querytape.Osuf vmgr_reclaim.Osuf vmgr_settag.Osuf vmgr_tpmounted.Osuf vmgr_updatetape.Osuf send2vmgr.Osuf vmgrcheck.Osuf
SharedLibraryTarget(castorvmgr,$(VMGRLIB_OBJS),$(DEPLIB),$(LIBS))
#endif

#if BuildVolumeMgrClient
VMGRLIB = -L. -lcastorvmgr
VMGRDEP = SharedLibraryTargetName(castorvmgr)
NormalProgramTarget(vmgrdeletedenmap,vmgrdeletedenmap.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrdeletedgnmap,vmgrdeletedgnmap.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrdeletelibrary,vmgrdeletelibrary.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrdeletemodel,vmgrdeletemodel.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrdeletepool,vmgrdeletepool.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrdeletetape,vmgrdeletetape.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrdeltag,vmgrdeltag.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrenterdenmap,vmgrenterdenmap.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrenterdgnmap,vmgrenterdgnmap.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrenterlibrary,vmgrenterlibrary.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrentermodel,vmgrentermodel.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrenterpool,vmgrenterpool.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrentertape,vmgrentertape.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,$(OPSGRP),755)
NormalProgramTarget(vmgrgettag,vmgrgettag.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrlistdenmap,vmgrlistdenmap.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrlistdgnmap,vmgrlistdgnmap.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrlistlibrary,vmgrlistlibrary.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrlistmodel,vmgrlistmodel.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrlistpool,vmgrlistpool.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrlisttape,vmgrlisttape.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
NormalProgramTarget(vmgrmodifylibrary,vmgrmodifylibrary.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,$(OPSGRP),755)
NormalProgramTarget(vmgrmodifypool,vmgrmodifypool.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,$(OPSGRP),755)
NormalProgramTarget(vmgrmodifytape,vmgrmodifytape.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,$(OPSGRP),755)
NormalProgramTarget(vmgrsettag,vmgrsettag.Osuf,$(VMGRDEP) $(DEPLIB),$(VMGRLIB) $(LIBS),root,bin,755)
EXEMANPAGE(vmgrdeletedenmap)
EXEMANPAGE(vmgrdeletedgnmap)
EXEMANPAGE(vmgrdeletelibrary)
EXEMANPAGE(vmgrdeletemodel)
EXEMANPAGE(vmgrdeletepool)
EXEMANPAGE(vmgrdeletetape)
EXEMANPAGE(vmgrdeltag)
EXEMANPAGE(vmgrenterdenmap)
EXEMANPAGE(vmgrenterdgnmap)
EXEMANPAGE(vmgrenterlibrary)
EXEMANPAGE(vmgrentermodel)
EXEMANPAGE(vmgrenterpool)
EXEMANPAGE(vmgrentertape)
EXEMANPAGE(vmgrgettag)
EXEMANPAGE(vmgrlistdenmap)
EXEMANPAGE(vmgrlistdgnmap)
EXEMANPAGE(vmgrlistlibrary)
EXEMANPAGE(vmgrlistmodel)
EXEMANPAGE(vmgrlistpool)
EXEMANPAGE(vmgrlisttape)
EXEMANPAGE(vmgrmodifylibrary)
EXEMANPAGE(vmgrmodifypool)
EXEMANPAGE(vmgrmodifytape)
EXEMANPAGE(vmgrsettag)
#endif

LIBMANPAGE(vmgr_deletedenmap)
LIBMANPAGE(vmgr_deletedgnmap)
LIBMANPAGE(vmgr_deletelibrary)
LIBMANPAGE(vmgr_deletemodel)
LIBMANPAGE(vmgr_deletepool)
LIBMANPAGE(vmgr_deletetape)
LIBMANPAGE(vmgr_deltag)
LIBMANPAGE(vmgr_enterdenmap)
LIBMANPAGE(vmgr_enterdgnmap)
LIBMANPAGE(vmgr_enterlibrary)
LIBMANPAGE(vmgr_entermodel)
LIBMANPAGE(vmgr_enterpool)
LIBMANPAGE(vmgr_entertape)
LIBMANPAGE(vmgr_gettag)
LIBMANPAGE(vmgr_gettape)
LIBMANPAGE(vmgr_listdenmap)
LIBMANPAGE(vmgr_listdgnmap)
LIBMANPAGE(vmgr_listlibrary)
LIBMANPAGE(vmgr_listmodel)
LIBMANPAGE(vmgr_listpool)
LIBMANPAGE(vmgr_listtape)
LIBMANPAGE(vmgr_modifylibrary)
LIBMANPAGE(vmgr_modifymodel)
LIBMANPAGE(vmgr_modifypool)
LIBMANPAGE(vmgr_modifytape)
LIBMANPAGE(vmgr_querylibrary)
LIBMANPAGE(vmgr_querymodel)
LIBMANPAGE(vmgr_querypool)
LIBMANPAGE(vmgr_querytape)
LIBMANPAGE(vmgr_reclaim)
LIBMANPAGE(vmgr_seterrbuf)
LIBMANPAGE(vmgr_settag)
LIBMANPAGE(vmgr_tpmounted)
LIBMANPAGE(vmgr_updatetape)
EXEMANPAGE(vmgr)
