.phony: all

all: valgrind valgrindMultiprocess helgrindBase helgrindScheduler helgrindOStoreDB helgrindDataTransfer helgrindInMemoryCatalogue helgrindMultiprocess
	
	
valgrind: valgrindMultiprocess helgrindMultiprocess
	valgrind -q @VALGRIND_OPTS_STR@                                               \
	--suppressions=/usr/share/cta-@CTA_VERSION@/unittest/valgrind.suppr           \
	/usr/bin/cta-unitTests

valgrindMultiprocess:
	valgrind -q @VALGRIND_OPTS_STR@ --child-silent-after-fork=yes                 \
	--suppressions=/usr/share/cta-@CTA_VERSION@/unittest/valgrind.suppr           \
	/usr/bin/cta-unitTests-multiProcess

helgrindBase: valgrindMultiprocess helgrindMultiprocess
	valgrind -q --tool=helgrind @HELGRIND_OPTS_STR@                               \
	--suppressions=/usr/share/cta-@CTA_VERSION@/unittest/helgrind.suppr           \
	/usr/bin/cta-unitTests                                                        \
	--gtest_filter=-OStoreDBPlusMockSchedulerTestVFS*:OStoreTestVFS*:OStoreDBPlusMockSchedulerTestVFS*:InMemory*

helgrindScheduler: valgrindMultiprocess helgrindMultiprocess
	valgrind -q --tool=helgrind @HELGRIND_OPTS_STR@                               \
	--suppressions=/usr/share/cta-@CTA_VERSION@/unittest/helgrind.suppr           \
	/usr/bin/cta-unitTests                                                        \
	--gtest_filter=OStoreDBPlusMockSchedulerTestVFS/Scheduler*

helgrindOStoreDB: valgrindMultiprocess helgrindMultiprocess
	valgrind -q --tool=helgrind @HELGRIND_OPTS_STR@                               \
	--suppressions=/usr/share/cta-@CTA_VERSION@/unittest/helgrind.suppr           \
	/usr/bin/cta-unitTests                                                        \
	--gtest_filter=OStoreTestVFS*

helgrindDataTransfer: valgrindMultiprocess helgrindMultiprocess
	valgrind -q --tool=helgrind @HELGRIND_OPTS_STR@                               \
	--suppressions=/usr/share/cta-@CTA_VERSION@/unittest/helgrind.suppr           \
	/usr/bin/cta-unitTests                                                        \
	--gtest_filter=OStoreDBPlusMockSchedulerTestVFS/DataTransferSessionTest*

helgrindInMemoryCatalogue: valgrindMultiprocess helgrindMultiprocess
	valgrind -q --tool=helgrind @HELGRIND_OPTS_STR@                               \
	--suppressions=/usr/share/cta-@CTA_VERSION@/unittest/helgrind.suppr           \
	/usr/bin/cta-unitTests                                                        \
	--gtest_filter=InMemory/*

helgrindMultiprocess: valgrindMultiprocess
	valgrind -q --tool=helgrind @HELGRIND_OPTS_STR@                               \
	--suppressions=/usr/share/cta-@CTA_VERSION@/unittest/helgrind.suppr           \
	/usr/bin/cta-unitTests-multiProcess