/*
 * Copyright (C) 1993-2004 by CERN/IT/PDP/DM
 * All rights reserved
 */

/*
 * @(#)$RCSfile$ $Revision$ $Date$ CERN IT-ADC/CA Jean-Damien Durand
 */

/* ============================= */
/* Build dependencies v.s. flags */
/* ============================= */

/* CUPVDAEMON,NAMESERVERDAEMON,VMGRDAEMON,DLFDAEMON needs UseOracle or UseMySQL */
/* ---------------------------------------------------------------------------- */
#if BuildCupvDaemon || BuildNameServerDaemon || BuildVolumeMgrDaemon || BuildDlfDaemon
#if !UseOracle && !UseMySQL
#undef UseOracle
#define UseOracle YES
#endif
#endif

/* RMMASTER needs [1]maui or lsf */
/* ----------------------------- */
#if BuildRmMaster
#if !UseMaui && !UseLsf
#undef UseMaui
#define UseMaui YES
#endif
#endif

/* RMNODE will be worker so it needs JOB */
/* ------------------------------------- */
#if BuildRmNode
#if !BuildJob
#undef BuildJob
#define BuildJob YES
#endif
#endif

/* JOB needs some ResourceMonitoring tools and daemon */
/* -------------------------------------------------- */
#if BuildJob
#if !BuildRmClient
#undef BuildRmClient
#define BuildRmClient YES
#endif
#if !BuildRmNode
#undef BuildRmNode
#define BuildRmNode YES
#endif
#endif

/* ========================================== */
/* Implicit dependencies because of libraries */
/* ========================================== */

/* --------------------------- */
/* We force COMMON in any case */
/* --------------------------- */
#if !BuildCommon
#undef BuildCommon
#define BuildCommon YES
#endif

/* ---- */
/* CUPV */
/* ---- */
#if BuildCupvClient || BuildCupvDaemon
#if !BuildCupvLibrary
#undef BuildCupvLibrary
#define BuildCupvLibrary YES
#endif
#endif

/* -------- */
/* HSMTOOLS */
/* -------- */
#if BuildHsmTools
#if !BuildNameServerLibrary
#undef BuildNameServerLibrary
#define BuildNameServerLibrary YES
#endif
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildRmLibrary
#undef BuildRmLibrary
#define BuildRmLibrary YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#endif

/* ------- */
/* MONITOR */
/* ------- */
#if BuildMonitorClient
#if !BuildMonitorLibrary
#undef BuildMonitorLibrary
#define BuildMonitorLibrary YES
#endif
#endif
#if BuildMonitorServer
#if !BuildMonitorLibrary
#undef BuildMonitorLibrary
#define BuildMonitorLibrary YES
#endif
#if !BuildMonitorLibrary
#undef BuildMonitorLibrary
#define BuildMonitorLibrary YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#endif

/* --- */
/* MSG */
/* --- */
#if BuildMsgClient || BuildMsgServer
#if !BuildMsgLibrary
#undef BuildMsgLibrary
#define BuildMsgLibrary YES
#endif
#endif

/* -- */
/* NS */
/* -- */
#if BuildNameServerClient || BuildNameServerDaemon
#if !BuildNameServerLibrary
#undef BuildNameServerLibrary
#define BuildNameServerLibrary YES
#endif
#endif

/* ---- */
/* RFIO */
/* ---- */
#if BuildRfioClient
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* --- */
/* RMC */
/* --- */
#if BuildRmcClient
#if !BuildRmcLibrary
#undef BuildRmcLibrary
#define BuildRmcLibrary YES
#endif
#endif
#if BuildRmcServer
#if !BuildRmcLibrary
#undef BuildRmcLibrary
#define BuildRmcLibrary YES
#endif
#if !BuildTapeLibrary
#undef BuildTapeLibrary
#define BuildTapeLibrary YES
#endif
#if !BuildCupvLibrary
#undef BuildCupvLibrary
#define BuildCupvLibrary YES
#endif
#endif

/* --- */
/* JOB */
/* --- */
#if BuildJob
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary	YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#if !BuildRmLibrary
#undef BuildRmLibrary
#define BuildRmLibrary YES
#endif
#endif

/* ------ */
/* RTCOPY */
/* ------ */
#if BuildRtcopyClient
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#if BuildVdqmLibrary != YES
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#endif

#if BuildRtcpclientd
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildExpertLibrary != YES
#undef BuildExpertLibrary
#define BuildExpertLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#if BuildVdqmLibrary != YES
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#if !BuildOraCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#endif

#if BuildRtcopyServer
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#if !BuildTapeLibrary
#undef BuildTapeLibrary
#define BuildTapeLibrary YES
#endif
#if BuildVdqmLibrary != YES
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

#if BuildRtstat
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* ------ */
/* STAGER */
/* ------ */
#if BuildStageClient
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

#if BuildStageDaemon
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if !BuildOraCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildCupvLibrary
#undef BuildCupvLibrary
#define BuildCupvLibrary YES
#endif
#if BuildExpertLibrary != YES
#undef BuildExpertLibrary
#define BuildExpertLibrary YES
#endif
#if BuildNameServerLibrary != YES
#undef BuildNameServerLibrary
#define BuildNameServerLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary	YES
#endif
#if BuildRmLibrary != YES
#undef BuildRmLibrary
#define BuildRmLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* ----------------- */
/* OLD STAGE CLIENTS */
/* ----------------- */
#if BuildStageClientOld
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* -------------------------------------------- */
/* RM (and job because job uses few RM clients) */
/*------------------------------------------ -- */
#if BuildRmMaster
#if !BuildRmLibrary
#undef BuildRmLibrary
#define BuildRmLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#if !BuildVdqmLibrary
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#endif

#if BuildRmNode || BuildRmClient || BuildJob
#if !BuildRmLibrary
#undef BuildRmLibrary
#define BuildRmLibrary YES
#endif
#endif

/* ---- */
/* TAPE */
/* ---- */
#if BuildTapeDaemon
#if !BuildTapeLibrary
#undef BuildTapeLibrary
#define BuildTapeLibrary YES
#endif
#if BuildMsgLibrary != YES
#undef BuildMsgLibrary
#define BuildMsgLibrary	YES
#endif
#if BuildRmcLibrary != YES
#undef BuildRmcLibrary
#define BuildRmcLibrary	YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#endif

#if BuildTapeClient
#if !BuildTapeLibrary
#undef BuildTapeLibrary
#define BuildTapeLibrary YES
#endif
#if BuildMsgLibrary != YES
#undef BuildMsgLibrary
#define BuildMsgLibrary	YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#endif

#if BuildTpusage
#if BuildRfioLibrary != YES
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* ---- */
/* TEST */
/* ---- */
/* TODO */

/* ---- */
/* VDQM */
/* ---- */
#if BuildVdqmClient || BuildVdqmServer
#if !BuildVdqmLibrary
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#endif

/* ---- */
/* VMGR */
/* ---- */
#if BuildVolumeMgrClient || BuildVolumeMgrDaemon
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif

/* --- */
/* DLF */
/* --- */
#if BuildDlfClient || BuildDlfDaemon
#if !BuildDlfLibrary
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#endif

/* ------ */
/* EXPERT */
/* ------ */
#if BuildExpertClient || BuildExpertDaemon
#if !BuildExpertLibrary
#undef BuildExpertLibrary
#define BuildExpertLibrary YES
#endif
#endif

/* ---------------*/
/* REQUEST HANDLER */
/* --------------- */
#if BuildRHCpp
#if !BuildOraCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary	YES
#endif
#if !BuildNameServerLibrary
#undef BuildNameServerLibrary
#define BuildNameServerLibrary YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#endif


/* --------------- */
/* New VDQM Server */
/* --------------- */
#if BuildVDQMCpp
#if !BuildOraCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#endif



/* ------------------ */
/* Garbage Collection */
/* ------------------ */
#if BuildGCCpp
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary	YES
#endif
#endif


/* ------- */
/* CPPTEST */
/* ------- */
#if BuildCppTest
#if !BuildOraCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#endif


/* -------- */
/* SECURITY */
/* -------- */
#if BuildSecurity
#if BuildCommon != YES
#undef BuildCommon
#define BuildCommon     YES
#endif
#endif


/* ======================= */
/* For hidden dependencies */
/* ======================= */
#include <LibraryDeps.tmpl>

/* ========================= */
/* Directories for the build */
/* ========================= */

#if BuildCommands
COMMANDSDIR = commands
#endif
#if BuildCommon
COMMONDIR = common
#endif
#if BuildCupvClient || BuildCupvDaemon || BuildCupvLibrary
UPVDIR = upv
#endif
#if BuildHsmTools
HSMTOOLSDIR = hsmtools
#endif
#if BuildMonitorClient || BuildMonitorServer || BuildMonitorLibrary
MONITORDIR = monitor
#endif
#if BuildMsgClient || BuildMsgServer || BuildMsgLibrary
MSGDIR = msg
#endif
#if BuildNameServerClient || BuildNameServerDaemon || BuildNameServerLibrary
NSDIR = ns
#endif
#if BuildRfioClient || BuildRfioServer || BuildRfioLibrary
RFIODIR = rfio
#endif
#if BuildRmcClient || BuildRmcServer || BuildRmcLibrary
RMCDIR = rmc
#endif
#if BuildJob
JOBDIR = job
#endif
#if BuildRtcopyClient || BuildRtcopyServer || BuildRtcopyLibrary || BuildRtstat
RTCOPYDIR = rtcopy
#endif
#if BuildStageClient || BuildStageDaemon || BuildStageLibrary
STAGEDIR = stager
#endif
#if BuildStageClientOld
STAGEDIROLD = stage
#endif
#if BuildRmClient || BuildRmMaster || BuildRmNode || BuildRmLibrary
RESOURCEMONITORINGDIR = resourcemonitoring
#endif
#if BuildTapeClient || BuildTapeDaemon || BuildTapeLibrary || BuildTpusage
TAPEDIR = tape
#endif
#if BuildVdqmClient || BuildVdqmServer || BuildVdqmLibrary
VDQMDIR = vdqm
#endif
#if BuildVolumeMgrClient || BuildVolumeMgrDaemon || BuildVolumeMgrLibrary
VMGRDIR = vmgr
#endif
#if BuildDlfClient || BuildDlfDaemon || BuildDlfLibrary
DLFDIR = dlf
#endif
#if BuildExpertClient || BuildExpertDaemon || BuildExpertLibrary
EXPERTDIR = expert
#endif
#if BuildRHCpp
RHCPPDIR = rh
#endif
#if BuildVDQMCpp
VDQMCPPDIR = vdqm
#endif
#if BuildGCCpp
GCCPPDIR = gc
#endif
#if BuildCastorClientCPPLibrary || BuildRHCpp || BuildVDQMCpp  || BuildGCCpp || BuildOraCpp || BuildMyCpp
COMMONCPPDIR = castor
#endif
#if BuildOraCpp
ORACPPDIR = ora
DBCPPDIR = db
#endif
#if BuildMyCpp
MYCPPDIR = mysql
DBCPPDIR = db
#endif
#if BuildGcDaemon
GCDIR = gc
#endif
#if BuildCppTest
COMMONCPPTESTDIR = castor
DBTESTCPPDIR = db
IOTESTCPPDIR = io
DBCTESTCPPDIR = dbC
STGSVCTESTCPPDIR = stgSvc
#endif
#if BuildSecurity
SECURITYDIR=security
#endif
#if BuildSchedPlugin
SCHEDULERDIR=scheduler
#endif
#if BuildTankPerfMonLibrary
TANKDIR=tank
#endif

/* Those directories are always defined because we always build at least */
/* COMMON library */
LIBDIR=lib
SHLIBDIR=shlib
