/*
 * Copyright (C) 1993-2004 by CERN/IT/PDP/DM
 * All rights reserved
 */

/*
 * @(#)$RCSfile$ $Revision$ $Date$ CERN IT-ADC/CA Jean-Damien Durand
 */

/* ============================= */
/* Build dependencies v.s. flags */
/* ============================= */

/* CUPVDAEMON,NAMESERVERDAEMON,VMGRDAEMON,DLFDAEMON need a Database */
/* ---------------------------------------------------------------- */
#if BuildCupvDaemon || BuildNameServerDaemon || BuildVolumeMgrDaemon || BuildDlfDaemon
#if !UseOracle && !UsePgSQL
#undef UseOracle
#define UseOracle YES
#endif
#endif

/* ========================================== */
/* Implicit dependencies because of libraries */
/* ========================================== */

/* --------------------------- */
/* We force COMMON in any case */
/* --------------------------- */
#if !BuildCommon
#undef BuildCommon
#define BuildCommon YES
#endif

/* ---- */
/* CUPV */
/* ---- */
#if BuildCupvClient || BuildCupvDaemon
#if !BuildCupvLibrary
#undef BuildCupvLibrary
#define BuildCupvLibrary YES
#endif
#endif

/* -------- */
/* HSMTOOLS */
/* -------- */
#if BuildHsmTools
#if !BuildNameServerLibrary
#undef BuildNameServerLibrary
#define BuildNameServerLibrary YES
#endif
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#endif

/* ------- */
/* MONITOR */
/* ------- */
#if BuildMonitorClient
#if !BuildMonitorLibrary
#undef BuildMonitorLibrary
#define BuildMonitorLibrary YES
#endif
#endif
#if BuildMonitorServer
#if !BuildMonitorLibrary
#undef BuildMonitorLibrary
#define BuildMonitorLibrary YES
#endif
#if !BuildMonitorLibrary
#undef BuildMonitorLibrary
#define BuildMonitorLibrary YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#endif

/* --- */
/* MSG */
/* --- */
#if BuildMsgClient || BuildMsgServer
#if !BuildMsgLibrary
#undef BuildMsgLibrary
#define BuildMsgLibrary YES
#endif
#endif

/* -- */
/* NS */
/* -- */
#if BuildNameServerClient || BuildNameServerDaemon
#if !BuildNameServerLibrary
#undef BuildNameServerLibrary
#define BuildNameServerLibrary YES
#endif
#endif

/* ---- */
/* RFIO */
/* ---- */
#if BuildRfioClient
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* --- */
/* RMC */
/* --- */
#if BuildRmcClient
#if !BuildRmcLibrary
#undef BuildRmcLibrary
#define BuildRmcLibrary YES
#endif
#endif
#if BuildRmcServer
#if !BuildRmcLibrary
#undef BuildRmcLibrary
#define BuildRmcLibrary YES
#endif
#if !BuildTapeLibrary
#undef BuildTapeLibrary
#define BuildTapeLibrary YES
#endif
#if !BuildCupvLibrary
#undef BuildCupvLibrary
#define BuildCupvLibrary YES
#endif
#endif

/* --- */
/* JOB */
/* --- */
#if BuildJob
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary	YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* ------ */
/* RTCOPY */
/* ------ */
#if BuildRtcopyClient
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#if BuildVdqmLibrary != YES
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#endif

#if BuildRtcpclientd
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildExpertLibrary != YES
#undef BuildExpertLibrary
#define BuildExpertLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#if BuildVdqmLibrary != YES
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#endif

#if BuildRtcopyServer
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#if !BuildTapeLibrary
#undef BuildTapeLibrary
#define BuildTapeLibrary YES
#endif
#if BuildVdqmLibrary != YES
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

#if BuildRtstat
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* ------ */
/* STAGER */
/* ------ */
#if BuildStageClient
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

#if BuildStageDaemon
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildCupvLibrary
#undef BuildCupvLibrary
#define BuildCupvLibrary YES
#endif
#if BuildExpertLibrary != YES
#undef BuildExpertLibrary
#define BuildExpertLibrary YES
#endif
#if BuildNameServerLibrary != YES
#undef BuildNameServerLibrary
#define BuildNameServerLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary	YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* ----------------- */
/* OLD STAGE CLIENTS */
/* ----------------- */
#if BuildStageClientOld
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* ---- */
/* TAPE */
/* ---- */
#if BuildTapeDaemon
#if !BuildTapeLibrary
#undef BuildTapeLibrary
#define BuildTapeLibrary YES
#endif
#if BuildMsgLibrary != YES
#undef BuildMsgLibrary
#define BuildMsgLibrary	YES
#endif
#if BuildRmcLibrary != YES
#undef BuildRmcLibrary
#define BuildRmcLibrary	YES
#endif
#if !BuildDlfLibrary
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#if !BuildVdqmLibrary
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#if !Accounting
#undef Accounting
#define Accounting YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#endif

#if BuildTapeClient
#if !BuildTapeLibrary
#undef BuildTapeLibrary
#define BuildTapeLibrary YES
#endif
#if BuildMsgLibrary != YES
#undef BuildMsgLibrary
#define BuildMsgLibrary	YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#endif

#if BuildTpusage
#if BuildRfioLibrary != YES
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#endif

/* ---- */
/* TEST */
/* ---- */
/* TODO */

/* ---- */
/* VDQM */
/* ---- */
#if BuildVdqmClient || BuildVdqmServer
#if !BuildVdqmLibrary
#undef BuildVdqmLibrary
#define BuildVdqmLibrary YES
#endif
#if !BuildRtcopyLibrary
#undef BuildRtcopyLibrary
#define BuildRtcopyLibrary YES
#endif
#if !BuildRfioLibrary
#undef BuildRfioLibrary
#define BuildRfioLibrary YES
#endif
#if UseVmgr
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif
#endif

/* ---- */
/* VMGR */
/* ---- */
#if BuildVolumeMgrClient || BuildVolumeMgrDaemon
#if !BuildVolumeMgrLibrary
#undef BuildVolumeMgrLibrary
#define BuildVolumeMgrLibrary YES
#endif
#endif

/* ------ */
/* EXPERT */
/* ------ */
#if BuildExpertClient || BuildExpertDaemon
#if !BuildExpertLibrary
#undef BuildExpertLibrary
#define BuildExpertLibrary YES
#endif
#endif
/* ---------------*/
/* REQUEST HANDLER */
/* --------------- */
#if BuildRHCpp
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary	YES
#endif
#if !BuildNameServerLibrary
#undef BuildNameServerLibrary
#define BuildNameServerLibrary YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#endif

/* --------------- */
/* New VDQM Server */
/* --------------- */
#if BuildVDQMCpp
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#endif

/* ----------------- */
/* New Repack        */
/* ----------------- */
#if BuildRepack
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#endif

/* ----------------- */
/* New MigHunter     */
/* ----------------- */

#if BuildMigHunterDaemon
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#if !BuildInfoPolicyLibrary
#undef BuildInfoPolicyLibrary
#define BuildInfoPolicyLibrary YES
#endif
#endif

/* -------------------- */
/* RecHandlerDaemon     */
/* -------------------- */

#if BuildRecHandlerDaemon
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#if !BuildInfoPolicyLibrary 
#undef BuildInfoPolicyLibrary
#define BuildInfoPolicyLibrary YES
#endif
#endif

/* ----------------- */
/* InfoPolicy Lib    */
/* ----------------- */
#if BuildInfoPolicyLibrary
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#endif


/* ----------------- */
/* Cleaning          */
/* ----------------- */
#if BuildCleaning
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#endif

/* ------------------ */
/* Garbage Collection */
/* ------------------ */
#if BuildGCCpp
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary	YES
#endif
#endif

/* ------------ */
/* New RmMaster */
/* ------------ */
#if BuildRmMasterCpp
#if !BuildStageLibrary
#undef BuildStageLibrary
#define BuildStageLibrary YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary	YES
#endif
#endif

/******************/
/* New JobManager */
/******************/
#if BuidlJobManagerCpp
#if BuildDlfLibrary != YES
#undef BuildDlfLibrary
#define BuildDlfLibrary YES
#endif
#endif

/* ------- */
/* CPPTEST */
/* ------- */
#if BuildCppTest
#if !BuildOraCpp && !BuildPgCpp && !BuildMyCpp
#undef BuildOraCpp
#define BuildOraCpp YES
#endif
#if !BuildCastorClientCPPLibrary
#undef BuildCastorClientCPPLibrary
#define BuildCastorClientCPPLibrary YES
#endif
#endif

/* -------- */
/* SECURITY */
/* -------- */
#if BuildSecurity
#if BuildCommon != YES
#undef BuildCommon
#define BuildCommon     YES
#endif
#endif


/* ======================= */
/* For hidden dependencies */
/* ======================= */
#include <LibraryDeps.tmpl>

/* ========================= */
/* Directories for the build */
/* ========================= */

CLIENTSDIR = client
#if BuildCommands
COMMANDSDIR = commands
#endif
#if BuildCommon
COMMONDIR = common
CNVCPPDIR = cnv
#endif
#if BuildCupvClient || BuildCupvDaemon || BuildCupvLibrary
UPVDIR = upv
#endif
#if BuildHsmTools
HSMTOOLSDIR = hsmtools
#endif
#if BuildMonitorClient || BuildMonitorServer || BuildMonitorLibrary
MONITORDIR = monitor
#endif
#if BuildMsgClient || BuildMsgServer || BuildMsgLibrary
MSGDIR = msg
#endif
#if BuildNameServerClient || BuildNameServerDaemon || BuildNameServerLibrary
NSDIR = ns
#endif
#if BuildRfioClient || BuildRfioServer || BuildRfioLibrary
RFIODIR = rfio
#endif
#if BuildRmcClient || BuildRmcServer || BuildRmcLibrary
RMCDIR = rmc
#endif
#if BuildJob
JOBDIR = job
#endif
#if BuildRtcopyClient || BuildRtcopyServer || BuildRtcopyLibrary || BuildRtstat
RTCOPYDIR = rtcopy
#endif
#if BuildStageClient || BuildStageDaemon || BuildStageLibrary
STAGEDIR = stager
#endif
#if BuildStageDaemonCpp
STAGERDIR = stager
DAEMONDIR = daemon
#endif
#if BuildStageClientOld
STAGEDIROLD = stage
#endif
#if BuildTapeClient || BuildTapeDaemon || BuildTapeLibrary || BuildTpusage
TAPEDIR = tape
#endif
#if BuildVdqmClient || BuildVdqmServer || BuildVdqmLibrary
VDQMDIR = vdqm
#endif
#if BuildVolumeMgrClient || BuildVolumeMgrDaemon || BuildVolumeMgrLibrary
VMGRDIR = vmgr
#endif
#if BuildDlfDaemon || BuildDlfLibrary
DLFDIR = dlf
#endif
#if BuildExpertClient || BuildExpertDaemon || BuildExpertLibrary
EXPERTDIR = expert
#endif
#if BuildRHCpp
RHCPPDIR = rh
#endif
#if BuildVDQMCpp
VDQMCPPDIR = vdqm
#endif
#if BuildRepack
REPACKDIR = repack
#endif
#if BuildMigHunterDaemon
MIGDIR = mighunter
RTCOPYDIR = rtcopy
#endif
#if BuildRecHandlerDaemon
RECDIR = rechandler
RTCOPYDIR = rtcopy
#endif
#if BuildInfoPolicyLibrary
INFOPOLICYDIR = infoPolicy
#endif
#if BuildCleaning
CLEANINGDIR = cleaning
#endif
#if BuildGCCpp
GCCPPDIR = gc
#endif
#if BuildCastorClientCPPLibrary || BuildRHCpp || BuildVDQMCpp || BuildCleaning || BuildGCCpp || BuildOraCpp || BuildPgCpp || BuildMyCpp || BuildStageDaemonCpp || BuildRmMasterCpp || BuildRmNodeCpp
COMMONCPPDIR = castor
#endif
#if BuildOraCpp
#if UseOraCDBC
ORACPPDIR = newora
#else
ORACPPDIR = ora
#endif
DBCPPDIR = db
#endif
#if BuildMyCpp
MYCPPDIR = mysql
DBCPPDIR = db
#endif
#if BuildPgCpp
PGCPPDIR = pgsql
DBCPPDIR = db
#endif
#if BuildCppTest
COMMONCPPTESTDIR = castor
DBTESTCPPDIR = db
IOTESTCPPDIR = io
DBCTESTCPPDIR = dbC
STGSVCTESTCPPDIR = stgSvc
MONITORINGTESTCPPDIR = monitoring
#endif
#if BuildSecurity
SECURITYDIR=security
#endif
#if BuildSchedPlugin
SCHEDULERDIR=scheduler
#endif
#if BuildDlfWeb
DLFWEBDIR=web
DLFWEB=/var/www/html/dlf
DLFCONF=/var/www/conf/dlf
#endif
#if BuildRmMasterCpp
MONITORINGDIR = monitoring
RMMASTERDIR = rmmaster
RMADMINDIR = admin
#endif
#if BuildRmNodeCpp
MONITORINGDIR = monitoring
RMNODEDIR = rmnode
#endif
#if BuildJobManagerCpp
JOBMANAGERDIR = jobmanager
DISKCOPYDIR = diskcopy
#endif
#if BuildGridFTP
GRIDFTPDIR = gridftp2
#endif

/* Those directories are always defined because we always build at least */
/* COMMON library */
LIBDIR=lib
SHLIBDIR=shlib
